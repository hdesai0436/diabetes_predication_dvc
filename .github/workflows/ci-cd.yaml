name: ci

# run the workflow on every push to main branch

on:
  push:
    branches:
      - 'main'
    
# your work flow job 
jobs:
  build:
    runs-on: ubuntu-latest
    container: docker://dvcorg/cml-py3:latest
    steps:
      -
        name: Checkout
        uses: actions/checkout@v3
      - 
        name: intsall requ
        run: pip install -r requirements.txt
      -
        name: Pull data & run-cache from IBM COS
        run: |
            dvc remote modify --local storage_data access_key_id ${{secrets.S3_ACCESS_KEY}}
            dvc remote modify --local storage_data secret_access_key ${{S3_SECREAT_KEY}}
            dvc pull --run-cache
      - 
        name: reproduce pipeline
        run: dvc repro
      - 
        name: Report metrics
        run: | 
          echo "## Metrics" >> README.md
          git fetch --prune
          dvc metrics diff master --show-md >> README.md
      









    

        

